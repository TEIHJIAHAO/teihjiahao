<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="./decorate.css">
    <title>Document</title>
</head>
<body>

   <audio src="./By2_-_(mp3.pm).mp3" class="audio" loop></audio> 

    <div class="box box0 ">     
        <div class="main_head">
            <div class="heading">这</div>
            <div class="heading">是</div>
            <div class="heading">一</div>
            <div class="heading">个</div>
            <div class="heading">男</div>
            <div class="heading">孩</div>
            <div class="heading">真</div>
            <div class="heading">挚</div>
            <div class="heading">的</div>
            <div class="heading">告</div>
            <div class="heading">白</div>
        </div>
    </div>

    <script>
            //click to play the music
            var box0= document.querySelector(".box0");
            var audio  = document.querySelector(".audio");
            box0.addEventListener('click', function() {
            audio.play(); 
            document.body.removeChild(box0);
            });
    </script>
       

    <div class="box box1">
    <div class="main">
     <img src="./tittle2.png" class="tittle">
     <!-- <div class="heading">成璟，我想认真喜欢你！</div> -->
     <img src="./bubu4.gif" class="head">
     <div class="box-button"><div class="button button_start"><span>现在开始</span></div></div>
     <div class="box-button remove"><div class="button button_end"><span>马上离开</span></div></div>
    </div>
    </div> 

    <script>
        var box1 = document.querySelector(".box1");
        var main= document.querySelector(".main");
        var start = document.querySelector(".button_start");
        var end   = document.querySelector(".button_end");
        var remove   = document.querySelector(".remove");
        var fontSize    = 3 ;
        var lineHeight  = 10 ;
        var index = 0;

        //if click button start, remove and go to next page
         start.addEventListener('click', function() {
         document.body.removeChild(box1);});

        //if click button end, move it.
        end.addEventListener('click', function() {
        //end.style.position='absolute';

           var array = ['不要这样嘛','我要生气了','不管你了']; 

           //remove button end after 4 times
           end.innerHTML = array[index];index++;
           if (index == 4) {main.removeChild(remove);}

           end.style.backgroundColor = 'red';

           // 1. Get the dimensions of the frame and the box
            // var frameWidth  = box1.clientWidth;
            // var frameHeight = box1.clientHeight;
            // var boxWidth    = end.offsetWidth;
            // var boxHeight   = end.offsetHeight;

           // 2. Calculate max available space
            // var maxX = frameWidth - boxWidth;
            // var maxY = frameHeight - boxHeight;

           // 3. Generate random numbers within that range
            // var randomX = Math.floor(Math.random() * maxX);
            // var randomY = Math.floor(Math.random() * maxY);

           // 4. Apply the new position
            // end.style.left = randomX + 'px';
            // end.style.top = randomY + 'px';

           //5. increase the element size
            // fontSize = fontSize * 1.1 ;
            // lineHeight = lineHeight * 1.1 ;
            // end.style.width = boxWidth * 1.0 + 'px';
            // end.style.height = boxHeight * 1.0 + 'px';
            // end.style.fontSize = fontSize + 'vh';
            // end.style.lineHeight = lineHeight + 'vh';

        });

    </script>
   
    <div class="box box2">
        <div class="flexbox">
             <div class="heading level_head">Level 0</div>
             <div class="heading">请帮助嘉昊得到成璟的心</div>
             <img src="./bubu2.gif" class="head">
             <div class="heart">
                 <div><i class="fa-solid fa-heart"></i></div>
                 <div><i class="fa-solid fa-heart"></i></div>
                 <div><i class="fa-solid fa-heart"></i></div>
                 <div><i class="fa-solid fa-heart"></i></div>
                 <div><i class="fa-solid fa-heart"></i></div>
                 <div><i class="fa-solid fa-heart"></i></div>
             </div>
             <div class="box-button"><div class="button button_page2"><span> 开始升级 </span></div></div>
        </div>
    </div>

    <script>
        var box2= document.querySelector(".box2");
        var button= document.querySelector(".button_page2");
        button.addEventListener('click', function() {
        document.body.removeChild(box2);});
    </script>  

    <div class="box box3">
        <div class="flexbox">
             <div class="heading level_head">第一关</div>
             <div class="question">
                <div class="wrap">
                    <div class="ask"> <b> 背景是一个极简的深色空间，只有一道光打在你和她之间。如果我现在就这样盯着你的眼睛看超过 10 秒，你觉得我会先对你做什么？</b> <br><br></div>
                    <div class="reply1"><i class="fa-solid fa-play"></i> <span>&nbsp; 忍不住吻下去。</span> </div>
                    <div class="reply2"><i class="fa-solid fa-circle"></i><span>&nbsp; 把你拉进怀里，不让你看我发红的脸。</span></div>
                    <div class="reply3"><i class="fa-solid fa-xmark"></i><span>&nbsp; 凑到你耳边问你：‘你心跳怎么这么快？</span> </div>
                    <div class="reply4"><i class="fa-solid fa-square"></i><span>&nbsp; 以上三件事，我会按顺序做一遍。</span> </div>
                </div>
            </div>
             <div class="container">
                <div class="box-answer"><div class="answer answer1 a1"><i class="fa-solid fa-play"></i></div></div>
                <div class="box-answer"><div class="answer answer2 a2"><i class="fa-solid fa-circle"></i></div></div>
                <div class="box-answer"><div class="answer answer3 a3"><i class="fa-solid fa-xmark"></i></div></div>
                <div class="box-answer"><div class="answer answer4 a4"><i class="fa-solid fa-square"></i></div></div>
             </div>
             
        </div>
    </div>

    <script>

     var box3   = document.querySelector(".box3");
     var answer1= document.querySelector(".a1");
     var answer2= document.querySelector(".a2");
     var answer3= document.querySelector(".a3");
     var answer4= document.querySelector(".a4");

     answer1.addEventListener('click',correct);
     answer2.addEventListener('click',wrong);
     answer3.addEventListener('click',wrong);
     answer4.addEventListener('click',correct);

     function correct (){document.body.removeChild(box3);} 
     function wrong   (){this.style.backgroundColor = 'gray'}

    </script>

    <div class="box box4">
        <div class="flexbox">
             <div class="heading level_head">Level 1</div>
             <div class="heading">其实看到你的第一秒，我就已经投降了。</div>
             <img src="./bubu9.gif" class="head">
             <div class="heart">
                 <div class="red"><i class="fa-solid fa-heart"></i></div>
                 <div><i class="fa-solid fa-heart"></i></div>
                 <div><i class="fa-solid fa-heart"></i></div>
                 <div><i class="fa-solid fa-heart"></i></div>
                 <div><i class="fa-solid fa-heart"></i></div>
                 <div><i class="fa-solid fa-heart"></i></div>
             </div>
             <div class="box-button"><div class="button button_page4"><span>  继续升级 </span></div></div>
        </div>
    </div>

    <script>
        var box4= document.querySelector(".box4");
        var button= document.querySelector(".button_page4");
        button.addEventListener('click', function() {
        document.body.removeChild(box4);});
    </script>

     <div class="box box5">
        <div class="flexbox">
             <div class="heading level_head">第二关</div>
             <div class="question">
                <div class="wrap">
                    <div class="ask"> <b>  检测到我的‘心动频率’已经到达临界值。作为我的‘甲方’，你打算怎么负责？ </b>  <br><br></div>
                    <div class="reply1"><i class="fa-solid fa-play"></i> <span>&nbsp; 罚我一辈子只能对你一个人好。</span> </div>
                    <div class="reply2"><i class="fa-solid fa-circle"></i><span>&nbsp; 没收我的全部时间，只能陪着你。</span></div>
                    <div class="reply3"><i class="fa-solid fa-xmark"></i><span>&nbsp;  既然坏了，那就把你的心赔给我。</span> </div>
                    <div class="reply4"><i class="fa-solid fa-square"></i><span>&nbsp;  别废话，直接亲我。</span> </div>
                </div>
            </div>
             <div class="container">
                <div class="box-answer"><div class="answer answer1 a5"><i class="fa-solid fa-play"></i></div></div>
                <div class="box-answer"><div class="answer answer2 a6"><i class="fa-solid fa-circle"></i></div></div>
                <div class="box-answer"><div class="answer answer3 a7"><i class="fa-solid fa-xmark"></i></div></div>
                <div class="box-answer"><div class="answer answer4 a8"><i class="fa-solid fa-square"></i></div></div>
             </div>
             
        </div>
    </div>

    <script>

     var box5   = document.querySelector(".box5");
     var answer5= document.querySelector(".a5");
     var answer6= document.querySelector(".a6");
     var answer7= document.querySelector(".a7");
     var answer8= document.querySelector(".a8");

     answer5.addEventListener('click',wrong);
     answer6.addEventListener('click',wrong);
     answer7.addEventListener('click',wrong);
     answer8.addEventListener('click',correct);

     function correct (){document.body.removeChild(box5);} 
     function wrong   (){this.style.backgroundColor = 'gray'}

    </script>

    <div class="box box6">
        <div class="flexbox">
             <div class="heading level_head">Level 2</div>
             <div class="heading">遵命! 这个‘维修方案’我申请执行一辈子。</div>
             <img src="./bubu8.gif" class="head">
             <div class="heart">
                 <div class="red"><i class="fa-solid fa-heart"></i></div>
                 <div class="red"><i class="fa-solid fa-heart"></i></div>
                 <div><i class="fa-solid fa-heart"></i></div>
                 <div><i class="fa-solid fa-heart"></i></div>
                 <div><i class="fa-solid fa-heart"></i></div>
                 <div><i class="fa-solid fa-heart"></i></div>
             </div>
             <div class="box-button"><div class="button button_page6"><span>  继续升级 </span></div></div>
        </div>
    </div>

    <script>
        var box6= document.querySelector(".box6");
        var button= document.querySelector(".button_page6");
        button.addEventListener('click', function() {
        document.body.removeChild(box6);});
    </script>

    <div class="box box7">
        <div class="flexbox">
             <div class="heading level_head">第三关</div>
             <div class="question">
                <div class="wrap">
                    <div class="ask">  <b>  如果全世界都消失了，只剩下我们两个，你觉得我第一件事会做什么？ </b>  <br><br></div>
                    <div class="reply1"><i class="fa-solid fa-play"></i> <span>&nbsp;终于可以肆无忌惮地抱着你，不撒手。</span> </div>
                    <div class="reply2"><i class="fa-solid fa-circle"></i><span>&nbsp;告诉那群追求者，你现在归我‘私有’了。</span></div>
                    <div class="reply3"><i class="fa-solid fa-xmark"></i><span>&nbsp;找个没人的地方把刚欠下的那个吻补回来。</span> </div>
                    <div class="reply4"><i class="fa-solid fa-square"></i><span>&nbsp;庆幸终于没有人，能跟我抢你的视线了。</span> </div>
                </div>
            </div>
             <div class="container">
                <div class="box-answer"><div class="answer answer1 a9"><i class="fa-solid fa-play"></i></div></div>
                <div class="box-answer"><div class="answer answer2 a10"><i class="fa-solid fa-circle"></i></div></div>
                <div class="box-answer"><div class="answer answer3 a11"><i class="fa-solid fa-xmark"></i></div></div>
                <div class="box-answer"><div class="answer answer4 a12"><i class="fa-solid fa-square"></i></div></div>
             </div>
             
        </div>
    </div>

    <script>

     var box7   = document.querySelector(".box7");
     var answer9= document.querySelector(".a9");
     var answer10= document.querySelector(".a10");
     var answer11= document.querySelector(".a11");
     var answer12= document.querySelector(".a12");

     answer9.addEventListener('click',wrong);
     answer10.addEventListener('click',wrong);
     answer11.addEventListener('click',correct);
     answer12.addEventListener('click',wrong);

     function correct (){document.body.removeChild(box7);} 
     function wrong   (){this.style.backgroundColor = 'gray'}

    </script>

    <div class="box box8">
        <div class="flexbox">
             <div class="heading level_head">Level 3</div>
             <div class="heading">哪怕世界不消失，你也是我这辈子的唯一。</div>
             <img src="./bubu6.gif" class="head">
             <div class="heart">
                 <div class="red"><i class="fa-solid fa-heart"></i></div>
                 <div class="red"><i class="fa-solid fa-heart"></i></div>
                 <div class="red"><i class="fa-solid fa-heart"></i></div>
                 <div><i class="fa-solid fa-heart"></i></div>
                 <div><i class="fa-solid fa-heart"></i></div>
                 <div><i class="fa-solid fa-heart"></i></div>
             </div>
              <div class="box-button"><div class="button button_page8"><span>  继续升级 </span></div></div>
        </div>
    </div>

    <script>
        var box8= document.querySelector(".box8");
        var button= document.querySelector(".button_page8");
        button.addEventListener('click', function() {
        document.body.removeChild(box8);});
    </script>

    <div class="box box9">
        <div class="flexbox">
             <div class="heading level_head">第四关</div>
             <div class="question">
                <div class="wrap">
                    <div class="ask">  <b>  昨晚我梦到你了，场景有点不可描述。你猜梦里的你在对我做什么？ </b>  <br><br></div>
                    <div class="reply1"><i class="fa-solid fa-play"></i> <span>&nbsp;在我怀里撒娇说不想起床。</span> </div>
                    <div class="reply2"><i class="fa-solid fa-circle"></i><span>&nbsp;抢我的被子，还要我抱紧你。</span></div>
                    <div class="reply3"><i class="fa-solid fa-xmark"></i><span>&nbsp;悄悄在我耳边说：‘我其实也超级喜欢你’。</span> </div>
                    <div class="reply4"><i class="fa-solid fa-square"></i><span>&nbsp; 你什么都没做，只是站在那，我就想把全世界都给你。</span> </div>
                </div>
            </div>
             <div class="container">
                <div class="box-answer"><div class="answer answer1 a13"><i class="fa-solid fa-play"></i></div></div>
                <div class="box-answer"><div class="answer answer2 a14"><i class="fa-solid fa-circle"></i></div></div>
                <div class="box-answer"><div class="answer answer3 a15"><i class="fa-solid fa-xmark"></i></div></div>
                <div class="box-answer"><div class="answer answer4 a16"><i class="fa-solid fa-square"></i></div></div>
             </div>
             
        </div>
    </div>

    <script>

     var box9   = document.querySelector(".box9");
     var answer13 = document.querySelector(".a13");
     var answer14= document.querySelector(".a14");
     var answer15= document.querySelector(".a15");
     var answer16= document.querySelector(".a16");

     answer13.addEventListener('click',wrong);
     answer14.addEventListener('click',correct);
     answer15.addEventListener('click',wrong);
     answer16.addEventListener('click',wrong);

     function correct (){document.body.removeChild(box9);} 
     function wrong   (){this.style.backgroundColor = 'gray'}

    </script>
    
     <div class="box box10">
        <div class="flexbox">
             <div class="heading level_head">Level 4</div>
             <div class="heading">梦里的你很乖，现实里的你，我想宠坏。</div>
             <img src="./bubu3.gif" class="head">
             <div class="heart">
                 <div class="red"><i class="fa-solid fa-heart"></i></div>
                 <div class="red"><i class="fa-solid fa-heart"></i></div>
                 <div class="red"><i class="fa-solid fa-heart"></i></div>
                 <div class="red"><i class="fa-solid fa-heart"></i></div>
                 <div><i class="fa-solid fa-heart"></i></div>
                 <div><i class="fa-solid fa-heart"></i></div>
             </div>
              <div class="box-button"><div class="button button_page10"><span>  继续升级 </span></div></div>
        </div>
    </div>

    <script>
        var box10= document.querySelector(".box10");
        var button= document.querySelector(".button_page10");
        button.addEventListener('click', function() {
        document.body.removeChild(box10);});
    </script>

    <div class="box box11">
        <div class="flexbox">
             <div class="heading level_head">第五关</div>
             <div class="question">
                <div class="wrap">
                    <div class="ask">  <b>  作为设计师，我这辈子接过的最难搞、最昂贵、也最想做一辈子的项目是什么？ </b>  <br><br></div>
                    <div class="reply1"><i class="fa-solid fa-play"></i> <span>&nbsp;渲染一个完美的家。</span> </div>
                    <div class="reply2"><i class="fa-solid fa-circle"></i><span>&nbsp; 拿下一个建筑大奖。</span></div>
                    <div class="reply3"><i class="fa-solid fa-xmark"></i><span>&nbsp;让你成为我户口本上的‘常驻人口’。</span> </div>
                    <div class="reply4"><i class="fa-solid fa-square"></i><span>&nbsp; 每天研究‘如何让你更爱我’这个课题。</span> </div>
                </div>
            </div>
             <div class="container">
                <div class="box-answer"><div class="answer answer1 a17"><i class="fa-solid fa-play"></i></div></div>
                <div class="box-answer"><div class="answer answer2 a18"><i class="fa-solid fa-circle"></i></div></div>
                <div class="box-answer"><div class="answer answer3 a19"><i class="fa-solid fa-xmark"></i></div></div>
                <div class="box-answer"><div class="answer answer4 a20"><i class="fa-solid fa-square"></i></div></div>
             </div>
             
        </div>
    </div>

    <script>

     var box11   = document.querySelector(".box11");
     var answer17 = document.querySelector(".a17");
     var answer18= document.querySelector(".a18");
     var answer19= document.querySelector(".a19");
     var answer20= document.querySelector(".a20");

     answer17.addEventListener('click',wrong);
     answer18.addEventListener('click',wrong);
     answer19.addEventListener('click',correct);
     answer20.addEventListener('click',wrong);

     function correct (){document.body.removeChild(box11);} 
     function wrong   (){this.style.backgroundColor = 'gray'}

    </script>
    
     <div class="box box12">
        <div class="flexbox">
             <div class="heading level_head">Level 5</div>
             <div class="heading">这个项目没有截止日期，只有执子之手，与子偕老。</div>
             <img src="./bubu7.gif" class="head">
             <div class="heart">
                 <div class="red"><i class="fa-solid fa-heart"></i></div>
                 <div class="red"><i class="fa-solid fa-heart"></i></div>
                 <div class="red"><i class="fa-solid fa-heart"></i></div>
                 <div class="red"><i class="fa-solid fa-heart"></i></div>
                 <div class="red"><i class="fa-solid fa-heart"></i></div>
                 <div><i class="fa-solid fa-heart"></i></div>
             </div>
              <div class="box-button"><div class="button button_page12"><span>  继续升级 </span></div></div>
        </div>
    </div>

    <script>
        var box12= document.querySelector(".box12");
        var button= document.querySelector(".button_page12");
        button.addEventListener('click', function() {
        document.body.removeChild(box12);});
    </script>

    <div class="box box13">
        <div class="flexbox">
             <div class="heading level_head">第六关</div>
             <div class="question">
                <div class="wrap">
                    <div class="ask">  <b>  前面的关卡你都通关了。现在，我想正式申请成为你的‘唯一合法持有人’，你的回复是？  </b> <br><br></div>
                    <div class="reply1"><i class="fa-solid fa-play"></i> <span>&nbsp; 我愿意</span> </div>
                    <div class="reply2"><i class="fa-solid fa-circle"></i><span>&nbsp; 你是我的了</span></div>
                    <div class="reply3"><i class="fa-solid fa-xmark"></i><span>&nbsp;我不愿意</span> </div>
                    <div class="reply4"><i class="fa-solid fa-square"></i><span>&nbsp; 我不想要你了</span> </div>
                </div>
            </div>
             <div class="container">
                <div class="box-answer"><div class="answer answer1 a21"><i class="fa-solid fa-play"></i></div></div>
                <div class="box-answer"><div class="answer answer2 a22"><i class="fa-solid fa-circle"></i></div></div>
                <div class="box-answer"><div class="answer answer3 a23"><i class="fa-solid fa-xmark"></i></div></div>
                <div class="box-answer"><div class="answer answer4 a24"><i class="fa-solid fa-square"></i></div></div>
             </div>
             
        </div>
    </div>

    <script>

     var box13   = document.querySelector(".box13");
     var answer21 = document.querySelector(".a21");
     var answer22= document.querySelector(".a22");
     var answer23= document.querySelector(".a23");
     var answer24= document.querySelector(".a24");

     answer21.addEventListener('click',wrong);
     answer22.addEventListener('click',correct);
     answer23.addEventListener('click',wrong);
     answer24.addEventListener('click',wrong);

     function correct (){document.body.removeChild(box13);} 
     function wrong   (){this.style.backgroundColor = 'gray'}

    </script>
    
    <div class="box box14">
        <div class="flexbox">
             <div class="heading level_head">Level 6</div>
             <div class="heading">恭喜通关，现在请抬头，看向你这辈子躲不掉的那个男人。</div>
             <img src="./bubu1.gif" class="head">
             <div class="heart">
                 <div class="red"><i class="fa-solid fa-heart"></i></div>
                 <div class="red"><i class="fa-solid fa-heart"></i></div>
                 <div class="red"><i class="fa-solid fa-heart"></i></div>
                 <div class="red"><i class="fa-solid fa-heart"></i></div>
                 <div class="red"><i class="fa-solid fa-heart"></i></div>
                 <div class="red"><i class="fa-solid fa-heart"></i></div>
             </div>
             <div class="box-button"><div class="button button_page14"><span>  完成升级 </span></div></div>
        </div>
    </div>


    <script>
        var box14= document.querySelector(".box14");
        var button= document.querySelector(".button_page14");
        button.addEventListener('click', function() {
        document.body.removeChild(box14);});
    </script>

    <div class="box box15">
        <div class="flexbox">
        <video class="video"  controls oncontextmenu="return false" controlsList="nodownload">
            <source src="./valentine.mp4" type="video/mp4" oncontextmenu="return false;" controlsList="nodownload">
        </video>
        <div class="box-button  button_done"><div class="button"><span>  签收告白 </span></div></div>
        </div>
    </div>

    <script>

        var video = document.querySelector(".video"); 
        var box15 = document.querySelector(".box15"); 
        var done = document.querySelector(".button_done"); 

        video.addEventListener('ended', function() {
        done.style.visibility = 'visible';
        audio.volume = 1;
        });

        video.addEventListener('play', function() {
        audio.volume = 0.2;
        });

        done.addEventListener('click', function() {
        document.body.removeChild(box15);});

    </script>
    
    <div class="box box16">     
        <div class="main_head">
            <div class="heading">你</div>
            <div class="heading">得</div>
            <div class="heading">到</div>
            <div class="heading">了</div>
            <div class="heading">一</div>
            <div class="heading">个</div>
            <div class="heading">爱</div>
            <div class="heading">你</div>
            <div class="heading">的</div>
            <div class="heading">嘉</div>
            <div class="heading">昊</div>
        </div>
    </div>

    <script>
        var box14= document.querySelector(".box16");
        box14.addEventListener('click', function() {
        document.body.removeChild(box14);});
    </script>

    <div class="box box17">
         <div class="back-image">
         <img src="./valentine.png" class="bottom-image">
         <canvas class="scratch-canvas" ></canvas>
        </div>
    </div>

    <script>
            const canvas = document.querySelector('.scratch-canvas');
            const ctx = canvas.getContext('2d');
            let isDrawing = false;
            let lastX = 0;
            let lastY = 0;

            // 【关键步】初始化：确保画布像素与显示大小一致
            function initCanvas() {
                // 获取 CSS 显示的大小
                const rect = canvas.getBoundingClientRect();
                // 将画布的分辨率设置为其实际显示的大小
                canvas.width = rect.width;
                canvas.height = rect.height;

                // 重新填充背景（因为改变 width 会清空画布）
                ctx.fillStyle = 'pink';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // 重新设置混合模式
                ctx.globalCompositeOperation = 'destination-out';
            }

            initCanvas();

            // 获取精准坐标的辅助函数
            function getPos(e) {
                const rect = canvas.getBoundingClientRect();
                const clientX = e.clientX || (e.touches && e.touches[0].clientX);
                const clientY = e.clientY || (e.touches && e.touches[0].clientY);
                
                // 计算缩放比，防止 CSS 缩放导致坐标不准
                const scaleX = canvas.width / rect.width;
                const scaleY = canvas.height / rect.height;

                return {
                    x: (clientX - rect.left) * scaleX,
                    y: (clientY - rect.top) * scaleY
                };
            }

            function scratch(e) {
                if (!isDrawing) return;
                if (e.cancelable) e.preventDefault(); // 阻止移动端滚动

                const { x, y } = getPos(e);

                ctx.beginPath();
                // 使用 lineTo 而不是 arc，可以保证快速划动时线条连续不间断
                ctx.lineWidth = 50; // 擦除宽度
                ctx.lineCap = 'round';
                ctx.lineJoin = 'round';
                ctx.moveTo(lastX, lastY);
                ctx.lineTo(x, y);
                ctx.stroke();

                // 更新上一次坐标
                [lastX, lastY] = [x, y];
            }

            // 事件监听
            canvas.addEventListener('mousedown', (e) => {
                isDrawing = true;
                const { x, y } = getPos(e);
                [lastX, lastY] = [x, y]; // 记录起点坐标
            });

            window.addEventListener('mouseup', () => isDrawing = false);
            canvas.addEventListener('mousemove', scratch);

            // 兼容移动端
            canvas.addEventListener('touchstart', (e) => {
                isDrawing = true;
                const { x, y } = getPos(e);
                [lastX, lastY] = [x, y];
            }, { passive: false });

            canvas.addEventListener('touchmove', scratch, { passive: false });
            canvas.addEventListener('touchend', () => isDrawing = false);

    </script>

</body>
</html>